name: generate Jokes
'on':
  schedule:
    - cron: 0 */24 * * *
  workflow_dispatch: null
jobs:
  get-joke:
    runs-on: ubuntu-latest
    steps:
      - name: Make API request
        run: >
          curl --location --request POST
          'https://api.openai.com/v1/chat/completions' \

          --header 'Content-Type: application/json' \

          --header 'Authorization: Bearer ${{ secrets.OPENAI_API_KEY }}' \

          --data-raw '{
             "model": "gpt-3.5-turbo",
             "messages": [{"role": "user", "content": "write a 4 line poem about cow "}],
              "temperature": 0.7
          }' > response.json
      - name:  Print response
        run: cat response.json
        
#       - name: location and list files
#         run : |
#           pwd
#           ls
        
      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: location and list files
        run : |
          pwd
          ls
        
      - name: Add response file
        run: git add .
        
      - name: Commit changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git commit -m "Add response data" -a
      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: '${{ secrets.GITHUB_TOKEN }}'
